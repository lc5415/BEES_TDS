geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28), y = 2.8,
label = paste0("Bonferroni\nadjusted\n\nsignificance level:\np =",
round(0.05/28,4)),
hjust = -.2, vjust = 1)+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28), y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance level:\np =",
round(0.05/28,4)),
hjust = -.2, vjust = 1)+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28), y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:\np =",
round(0.05/28,4)),
hjust = -.2, vjust = 1)+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28), y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = -.2, vjust = 1)+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28), y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+0.2, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28+0.2), y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28-0.2), y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)-0.2, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)-0.5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)-1, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)-10, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+10, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel:p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel()+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
?geom_label_repel
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7,
Biomarkers, "")))+
geom_point()+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
View(univtable)
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7|(OR>1.1 & -log10(p.value>40)),
Biomarkers, "")))+
geom_point()+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|OR<0.7|(OR>1.1 & -log10(p.value)>40)),
Biomarkers, ""))+
geom_point()+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
Biomarkers, ""))+
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|
OR<0.7|
(OR>1.1 & -log10(p.value)>40),
Biomarkers, "")))+
geom_point()+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|
OR<0.7|
(OR>1.1 & -log10(p.value)>40),
Biomarkers, "")))+
geom_point(fill = "black", color = "white")+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|
OR<0.7|
(OR>1.1 & -log10(p.value)>40),
Biomarkers, "")))+
geom_point(fill = "black", color = "white", shape = 22)+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|
OR<0.7|
(OR>1.1 & -log10(p.value)>40),
Biomarkers, "")))+
geom_point(fill = "black", color = "red", shape = 22)+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|
OR<0.7|
(OR>1.1 & -log10(p.value)>40),
Biomarkers, "")))+
geom_point(fill = "black", color = "red", shape = 23)+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|
OR<0.7|
(OR>1.1 & -log10(p.value)>40),
Biomarkers, "")))+
geom_point(fill = "black", color = "red", shape = 21)+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|
OR<0.7|
(OR>1.1 & -log10(p.value)>40),
Biomarkers, "")))+
geom_point(fill = "grey", color = "red", shape = 21)+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|
OR<0.7|
(OR>1.1 & -log10(p.value)>40),
Biomarkers, "")))+
geom_point(fill = "grey", color = "black", shape = 21)+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|
OR<0.7|
(OR>1.05 & -log10(p.value)>40),
Biomarkers, "")))+
geom_point(fill = "grey", color = "black", shape = 21)+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+5, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
univtable %>% filter(Data == "KNN") %>%
ggplot(aes(y = OR, x = -log10(p.value),
label = ifelse(-log10(p.value)>50|
OR<0.7|
(OR>1.05 & -log10(p.value)>40),
Biomarkers, "")))+
geom_point(fill = "grey", color = "black", shape = 21)+
geom_label_repel(min.segment.length = 0)+
ylim(0,NA)+
theme_bw()+xlab(expression("-log10(p-value)"))+
geom_vline(xintercept = -log10(0.05/28), linetype = "dashed")+
annotate("text", x = -log10(0.05/28)+3, y = 2.8,
label = paste0("Bonferroni\nadjusted\nsignificance\nlevel: p =",
round(0.05/28,4)),
hjust = "inward", vjust = "inward")+
ylab("Odds Ratio(OR)")+theme(text = element_text(size = 16))
plt.rds = read_csv("../FULLResults/EDA/bio_dist_impLOG.rds")
pltrds = read_csv("../FULLResults/EDA/bio_dist_impLOG.rds")
pltrds = readRDS("../FULLResults/EDA/bio_dist_impLOG.rds")
data = pltrds$data
View(data)
data$Biomarker = str_replace_all(data$Biomarker, "\\.", " ")
data$Biomarker = str_replace_all(data$Biomarker, "Glycated haemoglobin HbA1c", "HbA1c")
library(stringr)
data$Biomarker = str_replace_all(data$Biomarker, "\\.", " ")
data$Biomarker = str_replace_all(data$Biomarker, "Glycated haemoglobin HbA1c", "HbA1c")
data$Biomarker = str_replace_all(data$Biomarker, "Alanine aminotransferase", "Alanine\naminotransferase")
data$Biomarker = str_replace_all(data$Biomarker, "Alkaline phosphatase", "Alkaline\nphosphatase")
class(data$CVD_status)
?relevel
data$CVD_status = revalue(data$CVD_status, c("0"="Controls", "1"="Cases") )
data$CVD_status = plyr::revalue(data$CVD_status, c("0"="Controls", "1"="Cases") )
fig = data %>%
ggplot(aes(x = log10(Amount), color = CVD_status)) +
geom_density(alpha = 0)+
facet_wrap(Biomarker~.,
scales = "free")+
#theme_minimal()+
#scale_color_brewer(palette = "Set1")+
ggtitle("Biomarker distribution for imputed data(log scaled)")
fig
fig = data %>%
ggplot(aes(x = log10(Amount), color = CVD_status)) +
geom_density(alpha = 0)+
facet_wrap(Biomarker~.,
scales = "free")+
theme_bw()+
#scale_color_brewer(palette = "Set1")+
ggtitle("Biomarker distribution for imputed data(log scaled)")
fig = data %>%
ggplot(aes(x = log10(Amount), color = CVD_status)) +
geom_density(alpha = 0)+
facet_wrap(Biomarker~.,
scales = "free")+
theme_bw()+
scale_color_brewer(palette = "Set1")+
ggtitle("Biomarker distribution for imputed data(log scaled)")
fig
library(stringr)
pltrds = readRDS("../FULLResults/EDA/bio_dist_impLOG.rds")
data = pltrds$data
data$Biomarker = str_replace_all(data$Biomarker, "\\.", " ")
data$Biomarker = str_replace_all(data$Biomarker, "Glycated haemoglobin HbA1c", "HbA1c")
# data$Biomarker = str_replace_all(data$Biomarker, "Alanine aminotransferase", "Alanine\naminotransferase")
# data$Biomarker = str_replace_all(data$Biomarker, "Alkaline phosphatase", "Alkaline\nphosphatase")
data$CVD_status = plyr::revalue(data$CVD_status, c("0"="Controls", "1"="Cases") )
fig = data %>%
ggplot(aes(x = log10(Amount), color = CVD_status)) +
geom_density(alpha = 0)+
facet_wrap(Biomarker~.,
scales = "free")+
theme_bw()+
scale_color_brewer(palette = "Set1")+
ggtitle("Biomarker distribution for imputed data(log scaled)")
fig
fig = data %>%
ggplot(aes(x = log10(Amount), color = CVD_status)) +
geom_density(alpha = 0)+
facet_wrap(Biomarker~.,
scales = "free")+
theme_bw()+
scale_color_brewer(palette = "Set1")+
ggtitle("Biomarker distribution for imputed data(log scaled)")+
labs(color = "CVD status")
pltrds = readRDS("../FULLResults/EDA/bio_dist_impLOG.rds")
data = pltrds$data
data$Biomarker = str_replace_all(data$Biomarker, "\\.", " ")
data$Biomarker = str_replace_all(data$Biomarker, "Glycated haemoglobin HbA1c", "HbA1c")
data$Biomarker = str_replace_all(data$Biomarker, "Gamma glutamyltransferase", "GGT")
data$Biomarker = str_replace_all(data$Biomarker, "Alanine aminotransferase", "Alanine aminotrans.")
data$Biomarker = str_replace_all(data$Biomarker, "Alkaline phosphatase", "Alkaline phosph.")
data$CVD_status = plyr::revalue(data$CVD_status, c("0"="Controls", "1"="Cases") )
fig = data %>%
ggplot(aes(x = log10(Amount), color = CVD_status)) +
geom_density(alpha = 0)+
facet_wrap(Biomarker~.,
scales = "free")+
theme_bw()+
scale_color_brewer(palette = "Set1")+
ggtitle("Biomarker distribution for imputed data(log scaled)")+
labs(color = "CVD status")
fig
pltrds = readRDS("../FULLResults/EDA/bio_dist_impLOG.rds")
data = pltrds$data
data$Biomarker = str_replace_all(data$Biomarker, "\\.", " ")
data$Biomarker = str_replace_all(data$Biomarker, "Glycated haemoglobin HbA1c", "HbA1c")
data$Biomarker = str_replace_all(data$Biomarker, "Gamma glutamyltransferase", "GGT")
data$Biomarker = str_replace_all(data$Biomarker, "Alanine aminotransferase", "Alanine aminotrans.")
data$Biomarker = str_replace_all(data$Biomarker, "Alkaline phosphatase", "Alkaline phosph.")
data$Biomarker = str_replace_all(data$Biomarker, "Aspartate aminotransferase", "Aspartate aminotrans.")
data$CVD_status = plyr::revalue(data$CVD_status, c("0"="Controls", "1"="Cases") )
fig = data %>%
ggplot(aes(x = log10(Amount), color = CVD_status)) +
geom_density(alpha = 0)+
facet_wrap(Biomarker~.,
scales = "free")+
theme_bw()+
scale_color_brewer(palette = "Set1")+
ggtitle("Biomarker distribution for imputed data(log scaled)")+
labs(color = "CVD status")
fig
